<!DOCTYPE html>
<html lang="es">
<head>
    <script src="../js/ads-analytics.js"></script>     
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
    <title>Marcador de F√∫tbol Sala PRO | Liga Escolar</title>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../css/base.css">
    <link rel="stylesheet" href="../css/themes.css">
    <link rel="stylesheet" href="../css/layout.css">
    <link rel="stylesheet" href="../css/components.css">
    <link rel="stylesheet" href="../css/header-with-bg.css">
    <link rel="stylesheet" href="../css/sport-specific/futbol-sala.css">

</head>
<body class="theme-futbol-sala">
    <div class="container">
        <header class="app-header">
            <div class="header-bg">
                <img src="/imagenes/pizarra.png" alt="Pizarra" class="header-bg-image">
            </div>
            <div class="header-content">
                <div class="header-left">
                    <h1><i class="fas fa-running"></i> F√∫tbol Sala</h1>
                    <p class="subtitle">Liga Escolar - <span id="current-location">Pabell√≥n Municipal</span></p>
                    <div class="input-group">
                        <input type="text" id="match-location-input" placeholder="Ubicaci√≥n...">
                        <button class="btn btn-small" id="save-location"><i class="fas fa-check"></i></button>
                    </div>
                </div>
                <div class="header-right">
                    <div class="clock-container">
                        <div id="clock">00:00:00</div>
                        <div id="date">--/--/----</div>
                    </div>
                </div>
            </div>
        </header>

        <div class="scoreboard-fs">
            <div class="team-card" id="team1-area">
                <div class="team-name editable" id="team1-name" data-team="1">LOCAL</div>
                <div class="main-score" id="team1-score">0</div>
                <div class="stats-row">
                    <div class="stat-item">Faltas: <span id="team1-fouls">0</span></div>
                    <div class="stat-item">T. Muertos: <span id="team1-timeouts">1</span></div>
                </div>
                <div class="controls-grid">
                    <button class="btn btn-primary" onclick="addGoal('team1')">+ GOL</button>
                    <button class="btn btn-danger" onclick="addFoul('team1')">+ FALTA</button>
                    <button class="btn btn-warning" onclick="openCardModal('team1', 'yellow')">üü®</button>
                    <button class="btn btn-info" onclick="openCardModal('team1', 'blue')">üü¶</button>
                </div>
            </div>

            <div class="timer-area">
                <div id="period-label">Periodo 1</div>
                <div id="main-timer" class="timer-display">20:00</div>
                <div class="timer-controls">
                    <button class="btn btn-success" id="start-timer"><i class="fas fa-play"></i></button>
                    <button class="btn btn-warning" id="pause-timer"><i class="fas fa-pause"></i></button>
                    <button class="btn btn-secondary" id="reset-timer"><i class="fas fa-redo"></i></button>
                </div>
            </div>

            <div class="team-card" id="team2-area">
                <div class="team-name editable" id="team2-name" data-team="2">VISITANTE</div>
                <div class="main-score" id="team2-score">0</div>
                <div class="stats-row">
                    <div class="stat-item">Faltas: <span id="team2-fouls">0</span></div>
                    <div class="stat-item">T. Muertos: <span id="team2-timeouts">1</span></div>
                </div>
                <div class="controls-grid">
                    <button class="btn btn-primary" onclick="addGoal('team2')">+ GOL</button>
                    <button class="btn btn-danger" onclick="addFoul('team2')">+ FALTA</button>
                    <button class="btn btn-warning" onclick="openCardModal('team2', 'yellow')">üü®</button>
                    <button class="btn btn-info" onclick="openCardModal('team2', 'blue')">üü¶</button>
                </div>
            </div>
        </div>

        <div class="events-section">
            <h3><i class="fas fa-history"></i> Historial del Partido</h3>
            <div id="events-list" class="events-list">
                <div class="event-placeholder">Esperando inicio del encuentro...</div>
            </div>
        </div>

        <div class="action-buttons">
            <button class="btn btn-success" onclick="saveMatch()">
                <i class="fas fa-save"></i> Guardar en Historial
            </button>
            <button class="btn btn-whatsapp" onclick="shareWhatsApp()">
                <i class="fab fa-whatsapp"></i> Compartir WhatsApp
            </button>
            <button class="btn btn-share-alt" onclick="shareNative()">
                <i class="fas fa-share-nodes"></i> Otras Aplicaciones
            </button>
            <button class="btn btn-secondary" onclick="resetMatch()">
                <i class="fas fa-trash"></i> Reiniciar Partido
            </button>
        </div>
    </div>

    <div id="card-modal" class="modal" style="display:none;">
        <div class="modal-content">
            <h2 id="card-modal-title">Registrar Sanci√≥n</h2>
            <div class="form-group">
                <label>Dorsal del Jugador:</label>
                <input type="number" id="card-player-number" placeholder="Ej: 10">
            </div>
            <div class="modal-buttons">
                <button class="btn btn-secondary" onclick="closeCardModal()">Cancelar</button>
                <button class="btn btn-primary" onclick="saveCard()">Registrar</button>
            </div>
        </div>
    </div>

    <div id="team-name-modal" class="modal" style="display:none;">...</div>
    <div id="save-match-modal" class="modal" style="display:none;">...</div>

    <div class="notification" id="notification">
        <i class="fas fa-check-circle"></i>
        <span id="notification-text">Evento registrado</span>
    </div>

    <script src="../js/clock.js"></script>
    <script src="../js/celebrate.js"></script>
    <script src="../js/common.js"></script>
    <script src="../js/storage.js"></script>
    <script src="../js/match-core.js"></script>
    <script src="../js/modal-manager.js"></script>
    <script src="../js/futbol-sala.js"></script>

    <script>
        // Funciones de compartir integradas
        function shareWhatsApp() {
            const m = window.currentMatch;
            const text = `*Marcador F√∫tbol Sala* ‚öΩ\n${m.team1.name} *${m.team1.score} - ${m.team2.score}* ${m.team2.name}\nüìç ${m.location}\n_V√≠a ligaescolar.es_`;
            window.open(`https://wa.me/?text=${encodeURIComponent(text)}`, '_blank');
        }

        async function shareNative() {
            const m = window.currentMatch;
            const shareData = {
                title: 'Resultado de F√∫tbol Sala',
                text: `${m.team1.name} ${m.team1.score} - ${m.team2.score} ${m.team2.name}. Partido jugado en ${m.location}.`,
                url: window.location.href
            };
            try {
                await navigator.share(shareData);
            } catch (err) {
                console.log('Compartir no disponible en este navegador');
            }
        }
    </script>
</body>
</html>
